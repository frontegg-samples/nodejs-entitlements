"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.retry = void 0;
const logger_1 = require("../components/logger");
const retry = async (func, { numberOfTries, secondsDelayRange }) => {
    try {
        return await func();
    }
    catch (error) {
        logger_1.default.debug(`Failed, remaining tries: ${numberOfTries - 1}`);
        if (numberOfTries === 1) {
            throw error;
        }
        const delayTime = Math.floor(Math.random() * (secondsDelayRange.max - secondsDelayRange.min + 1)) + secondsDelayRange.min;
        logger_1.default.debug(`trying again in ${delayTime} seconds`);
        await delay(delayTime * 1000);
        return (0, exports.retry)(func, { numberOfTries: numberOfTries - 1, secondsDelayRange });
    }
};
exports.retry = retry;
const delay = (ms) => new Promise((resolve) => setTimeout(resolve, ms));
//# sourceMappingURL=index.js.map